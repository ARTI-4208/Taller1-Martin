vi Dockerfile^C
export DOCKER_ID_USER="morjuela"
docker login

docker build -t kubernetes-microsvinsumos:v10 --no-cache .
docker build -t kubernetes-microsvinsumos:v15 .
docker tag kubernetes-microsvinsumos:v15 $DOCKER_ID_USER/microsvinsumos
docker push $DOCKER_ID_USER/microsvinsumos
docker pull morjuela/microsvinsumos

docker run -it morjuela/microsvinsumos
docker run -it --rm kubernetes-microsvinsumos
docker run -d -P morjuela/microsvinsumos

docker ps | grep morjue
docker stop id

curl http://172.31.9.84:32772/insumos
{"error":true,"error_object":{"code":"ECONNREFUSED","errno":"ECONNREFUSED","syscall":"connect","address":"127.0.0.1","port":3306,"fatal":true}}root@ip-172-31-9-84:~/Taller1-Martin#

mysql -hlocalhost -uroot -p123
mysqladmin -uroot -p123 shutdown
service mysql stop
service mysql start

docker images | grep micros
%capturar id
docker rmi id_imagen -f


docker run -d -p 3306:3306 mysql


FROM node:6.9.2 
EXPOSE 3020
COPY package.json .
COPY microsvinsumos.js .
RUN npm install
CMD node microsvinsumos.js

FROM mysql:5.7
ENV MYSQL_ROOT_PASSWORD 123
ENV MYSQL_USER admin
ENV MYSQL_PASSWORD 123
USER root
RUN apt-get -y install mysql-server
CMD service mysql start
ADD setup.sql .
ADD run.sh .
RUN sh run.sh


root@ip-172-31-9-84:~/Taller1-Martin# docker run -it morjuela/microsvinsumos
error: database is uninitialized and password option is not specified
  You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORD
root@ip-172-31-9-84:~/Taller1-Martin#


FROM mysql:5.7
ADD my.cnf /etc/mysql/conf.d/my.cnf
RUN chown -R mysql:root /var/lib/mysql/
ARG MYSQL_DATABASE=insumos
ARG MYSQL_USER=admin
ARG MYSQL_PASSWORD=secret
ARG MYSQL_ROOT_PASSWORD=123
ENV MYSQL_DATABASE=$MYSQL_DATABASE
ENV MYSQL_USER=$MYSQL_USER
ENV MYSQL_PASSWORD=$MYSQL_PASSWORD
ENV MYSQL_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
RUN { \
        echo mysql-community-server mysql-community-server/root-pass password ${MYSQL_ROOT_PASSWORD}; \
        echo mysql-community-server mysql-community-server/re-root-pass password ${MYSQL_ROOT_PASSWORD}; \
    } | debconf-set-selections \
    && apt-get update && apt-get install -y mysql-server
USER root
COPY run.sh /docker-entrypoint-initdb.d/run.sh
ADD setup.sql .
ADD run.sh .
RUN sh run.sh


mysql -uroot -hlocalhost -p${MYSQL_ROOT_PASSWORD} -P3306 -e "CREATE USER '${MYSQL_USER}'@'%' IDENTIFIED BY '$PASS'"
mysql -uroot -hlocalhost -p${MYSQL_ROOT_PASSWORD} -P3306 -e "GRANT ALL PRIVILEGES ON insumos.* TO '${MYSQL_USER}'@'%' WITH GRANT OPTION"

